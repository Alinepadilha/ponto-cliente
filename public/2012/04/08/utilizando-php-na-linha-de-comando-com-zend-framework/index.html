<!DOCTYPE html>
<html lang="en">
<head>
    <!-- start: Meta -->
    <meta charset="utf-8">
    <title>Utilizando PHP na linha de comando com Zend Framework</title>
    <meta name="description" content="Magnus Bootstrap Theme" />
    <meta name="keywords" content="Template, Theme, web, html5, css3, Bootstrap" />
    <meta name="author" content="Łukasz Holeczek from creativeLabs" />
    <!-- end: Meta -->
    
    <!-- start: Mobile Specific -->
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <!-- end: Mobile Specific -->
    
    <!-- start: CSS -->
    <link href="/css/bootstrap.css" rel="stylesheet">
    <link href="/css/bootstrap-responsive.css" rel="stylesheet">
    <link href="/css/style.css" rel="stylesheet">
    <link href="/css/parallax-slider.css" rel="stylesheet">
    <link rel="stylesheet" type="text/css" href="http://fonts.googleapis.com/css?family=Droid+Sans:400,700">
    <link rel="stylesheet" type="text/css" href="http://fonts.googleapis.com/css?family=Droid+Serif">
    <link rel="stylesheet" type="text/css" href="http://fonts.googleapis.com/css?family=Boogaloo">
    <link rel="stylesheet" type="text/css" href="http://fonts.googleapis.com/css?family=Economica:700,400italic">
    <!-- end: CSS -->

    <!-- Le HTML5 shim, for IE6-8 support of HTML5 elements -->
    <!--[if lt IE 9]>
        <link href="/css/ie.css" rel="stylesheet">
        <script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <!--[if IE 9]>
        <link href="/css/ie9.css" rel="stylesheet">
    <![endif]-->
</head>
<body>
    <!--start: Header -->
    <header>
        <!--start: Container -->
        <div class="container">
            <!--start: Navigation -->
            <div class="navbar navbar-inverse">
                <div class="navbar-inner">
                    <a class="btn btn-navbar" data-toggle="collapse"
                        data-target=".nav-collapse"> <span class="icon-bar"></span> <span
                        class="icon-bar"></span> <span class="icon-bar"></span>
                    </a> 
                    <a class="brand" href="/"><i class="ico-thin-right-arrow ico-color circle"></i> mr<span>prompt</span></a>
                    <div class="nav-collapse collapse">
                        <ul class="nav">
                            <li><a href="/">Início</a></li>
                            <li><a href="/servicos">Serviços</a></li>
                            <li class="active"><a href="/blog">Blog</a></li>
                            <li><a href="/contato">Contato</a></li>
                        </ul>
                    </div>
                </div>
            </div>
            <!--end: Navigation -->

        </div>
        <!--end: Container-->

    </header>
    <!--end: Header-->

	<!-- start: Page Title -->
	<div id="page-title">
	    <div id="page-title-inner">
	        <!-- start: Container -->
	        <div class="container">
	            <h2>
	                <i class="ico-pencil"></i>Utilizando PHP na linha de comando com Zend Framework
	            </h2>
	        </div>
	        <!-- end: Container  -->
	    </div>
	</div>
	<!-- end: Page Title -->
	
	<!--start: Wrapper-->
	<div id="wrapper">
	    <!--start: Container -->
	    <div class="container">
	        <!--start: Row -->
	        <div class="row">
	            <div class="span9">
	                <p>Quem me conhece sabe que sempre gostei muito de brincar com o Terminal/Prompt, então, tenho costume de criar e utilizar vários 
scripts para automatizar algumas tarefas repetitivas, nos meus projetos, tenho costume de criar uma pasta &#39;bin&#39;, onde coloco os 
scripts que deverão rodar via <a href="http://en.wikipedia.org/wiki/Crontab">Cron</a> ou como um <a href="/2012/04/08/daemons-em-php/">Daemon</a>.</p>

<p>Mas assim como já utilizamos nosso framework favorito para fazermos nossos sites e/ou aplicações, porque não utilizarmos também 
para fazer nossos scripts?</p>

<p>Meu framework favorito atualmente, é o Zend, principalmente por ser modular - mas isso já é assunto para outro post ou conversa de bar -, 
então, vou apresentar abaixo, a estrutura básica de um script cli, utilizando o Zend.</p>

<div class="highlight"><pre><code class="language-php5" data-lang="php5"><span class="lineno"> 1</span> <span class="cp">&lt;?php</span>
<span class="lineno"> 2</span> <span class="sd">/**</span>
<span class="lineno"> 3</span> <span class="sd"> * Script PHP-CLI exemplo</span>
<span class="lineno"> 4</span> <span class="sd"> */</span>
<span class="lineno"> 5</span> <span class="nb">defined</span><span class="p">(</span><span class="s1">&#39;APPLICATION_PATH&#39;</span><span class="p">)</span>
<span class="lineno"> 6</span>     <span class="o">||</span> <span class="nb">define</span><span class="p">(</span><span class="s1">&#39;APPLICATION_PATH&#39;</span><span class="p">,</span> <span class="nx">__DIR__</span>  <span class="o">.</span> <span class="s1">&#39;/../application&#39;</span><span class="p">);</span>
<span class="lineno"> 7</span> 
<span class="lineno"> 8</span> <span class="nb">defined</span><span class="p">(</span><span class="s1">&#39;APPLICATION_ENV&#39;</span><span class="p">)</span>
<span class="lineno"> 9</span>     <span class="o">||</span> <span class="nb">define</span><span class="p">(</span>
<span class="lineno">10</span>         <span class="s1">&#39;APPLICATION_ENV&#39;</span><span class="p">,</span> <span class="p">(</span>
<span class="lineno">11</span>             <span class="nb">getenv</span><span class="p">(</span><span class="s1">&#39;APPLICATION_ENV&#39;</span><span class="p">)</span> <span class="o">?</span>
<span class="lineno">12</span>             <span class="nb">getenv</span><span class="p">(</span><span class="s1">&#39;APPLICATION_ENV&#39;</span><span class="p">)</span> <span class="o">:</span>
<span class="lineno">13</span>             <span class="s1">&#39;production&#39;</span>
<span class="lineno">14</span>         <span class="p">)</span>
<span class="lineno">15</span>     <span class="p">);</span>
<span class="lineno">16</span> 
<span class="lineno">17</span> <span class="nb">set_include_path</span><span class="p">(</span>
<span class="lineno">18</span>     <span class="nb">implode</span><span class="p">(</span>
<span class="lineno">19</span>         <span class="nx">PATH_SEPARATOR</span><span class="p">,</span>
<span class="lineno">20</span>         <span class="k">array</span><span class="p">(</span>
<span class="lineno">21</span>             <span class="nb">realpath</span><span class="p">(</span><span class="nx">APPLICATION_PATH</span> <span class="o">.</span> <span class="s1">&#39;/../library&#39;</span><span class="p">),</span>
<span class="lineno">22</span>             <span class="nb">get_include_path</span><span class="p">(),</span>
<span class="lineno">23</span>         <span class="p">)</span>
<span class="lineno">24</span>     <span class="p">)</span>
<span class="lineno">25</span> <span class="p">);</span>
<span class="lineno">26</span> 
<span class="lineno">27</span> <span class="c1">// Zend_Application</span>
<span class="lineno">28</span> <span class="k">require_once</span> <span class="s1">&#39;Zend/Application.php&#39;</span><span class="p">;</span>
<span class="lineno">29</span> 
<span class="lineno">30</span> <span class="c1">// E vamos lá, rodando a aplicação com suas configurações</span>
<span class="lineno">31</span> <span class="nv">$application</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Zend_Application</span><span class="p">(</span>
<span class="lineno">32</span>     <span class="nx">APPLICATION_ENV</span><span class="p">,</span>
<span class="lineno">33</span>     <span class="nx">APPLICATION_PATH</span> <span class="o">.</span> <span class="s1">&#39;/configs/application.ini&#39;</span>
<span class="lineno">34</span> <span class="p">);</span>
<span class="lineno">35</span> <span class="nv">$application</span><span class="o">-&gt;</span><span class="na">bootstrap</span><span class="p">();</span>
<span class="lineno">36</span> 
<span class="lineno">37</span> <span class="sd">/**</span>
<span class="lineno">38</span> <span class="sd"> * Aqui, configuro os parâmetros de entrada válidos</span>
<span class="lineno">39</span> <span class="sd"> * </span>
<span class="lineno">40</span> <span class="sd"> * teste.php --help</span>
<span class="lineno">41</span> <span class="sd"> * teste.php --start</span>
<span class="lineno">42</span> <span class="sd"> * tsete.php --stop</span>
<span class="lineno">43</span> <span class="sd"> */</span>
<span class="lineno">44</span> <span class="k">try</span> <span class="p">{</span>
<span class="lineno">45</span>     <span class="nv">$opts</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">\Zend_Console_Getopt</span><span class="p">(</span>
<span class="lineno">46</span>         <span class="k">array</span><span class="p">(</span>
<span class="lineno">47</span>             <span class="s1">&#39;help&#39;</span>  <span class="o">=&gt;</span> <span class="s1">&#39;Exibe esta ajuda.&#39;</span><span class="p">,</span>
<span class="lineno">48</span>             <span class="s1">&#39;start&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;Inicia.&#39;</span><span class="p">,</span>
<span class="lineno">49</span>             <span class="s1">&#39;stop&#39;</span>  <span class="o">=&gt;</span> <span class="s1">&#39;Encerra.&#39;</span><span class="p">,</span>
<span class="lineno">50</span>         <span class="p">)</span>
<span class="lineno">51</span>     <span class="p">);</span>
<span class="lineno">52</span> 
<span class="lineno">53</span>     <span class="nv">$opts</span><span class="o">-&gt;</span><span class="na">parse</span><span class="p">();</span>
<span class="lineno">54</span> <span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="nx">\Zend_Console_Getopt_Exception</span> <span class="nv">$e</span><span class="p">)</span> <span class="p">{</span>
<span class="lineno">55</span>     <span class="k">exit</span><span class="p">(</span><span class="nv">$e</span><span class="o">-&gt;</span><span class="na">getMessage</span><span class="p">()</span> <span class="o">.</span><span class="s2">&quot;</span><span class="se">\n\n</span><span class="s2">&quot;</span><span class="o">.</span> <span class="nv">$e</span><span class="o">-&gt;</span><span class="na">getUsageMessage</span><span class="p">());</span>
<span class="lineno">56</span> <span class="p">}</span>
<span class="lineno">57</span> 
<span class="lineno">58</span> <span class="k">if</span><span class="p">(</span><span class="nb">isset</span><span class="p">(</span><span class="nv">$opts</span><span class="o">-&gt;</span><span class="na">help</span><span class="p">))</span> <span class="p">{</span>
<span class="lineno">59</span>     <span class="k">echo</span> <span class="nv">$opts</span><span class="o">-&gt;</span><span class="na">getUsageMessage</span><span class="p">();</span>
<span class="lineno">60</span>     <span class="k">exit</span><span class="p">;</span>
<span class="lineno">61</span> <span class="p">}</span>
<span class="lineno">62</span> 
<span class="lineno">63</span> <span class="sd">/**</span>
<span class="lineno">64</span> <span class="sd"> * Action : start</span>
<span class="lineno">65</span> <span class="sd"> */</span>
<span class="lineno">66</span> <span class="k">if</span><span class="p">(</span><span class="nb">isset</span><span class="p">(</span><span class="nv">$opts</span><span class="o">-&gt;</span><span class="na">start</span><span class="p">))</span> <span class="p">{</span>
<span class="lineno">67</span>     <span class="c1">// nosso código</span>
<span class="lineno">68</span> <span class="p">}</span>
<span class="lineno">69</span> 
<span class="lineno">70</span> <span class="sd">/**</span>
<span class="lineno">71</span> <span class="sd"> * Action : stop</span>
<span class="lineno">72</span> <span class="sd"> */</span>
<span class="lineno">73</span> <span class="k">if</span><span class="p">(</span><span class="nb">isset</span><span class="p">(</span><span class="nv">$opts</span><span class="o">-&gt;</span><span class="na">stop</span><span class="p">))</span> <span class="p">{</span>
<span class="lineno">74</span>     <span class="c1">// nosso código</span>
<span class="lineno">75</span> <span class="p">}</span></code></pre></div>

<p>Bom, o código está bem simples de entender e auto explicativo. Basicamente, instanciamos o Zend<em>Application, normalmente, como fazemos 
em nosso index.php, para instanciarmos a app e tudo que for necessário para rodar.
Em seguida, com o Zend</em>Console_Getopt, definimos os parâmetros válidos, a partir daí, é só criar as funções de chamadas para as respectivas 
ações.</p>

<p>Pronto, agora é só dar asas a imaginação e se divertir um bocado com Zend e PHP-CLI.</p>

	            </div>
	
	            <!-- start: Sidebar -->
	            <div class="span3 hidden-phone">
	
	                <!-- start: Text Widget -->
	                <div class="widget first">
	                    <div class="title">
	                        <h3>Outros posts</h3>
	                    </div>
	                    <ul class="posts">
	                      
	                        <li>
	                          <span><i class="mini-ico-calendar"></i>03 Sep 2013</span> <br>
	                          <a class="post-link" href="/2013/09/03/resolvendo-o-problema-com-upload-de-arquivos-grandes-com-php-fpm-nginx/">Resolvendo o problema com upload de arquivos grandes no Nginx</a>
	                        </li>
	                      
	                        <li>
	                          <span><i class="mini-ico-calendar"></i>16 Aug 2013</span> <br>
	                          <a class="post-link" href="/2013/08/16/melhorando-a-completacao-de-codigo-auto-complete-do-netbeans/">Melhorando a completação de código (auto-complete) do NetBeans</a>
	                        </li>
	                      
	                        <li>
	                          <span><i class="mini-ico-calendar"></i>18 Apr 2013</span> <br>
	                          <a class="post-link" href="/2013/04/18/alterando-a-pasta-padrao-de-projetos-do-netbeans/">Alterando a pasta padrão de projetos do NetBeans</a>
	                        </li>
	                      
	                        <li>
	                          <span><i class="mini-ico-calendar"></i>24 Mar 2013</span> <br>
	                          <a class="post-link" href="/2013/03/24/php-gtk-no-lion/">PHP-GTK no Lion</a>
	                        </li>
	                      
	                        <li>
	                          <span><i class="mini-ico-calendar"></i>08 Apr 2012</span> <br>
	                          <a class="post-link" href="/2012/04/08/brincando-com-yql-yahoo-query-language/">Brincando com YQL - Yahoo Query Language</a>
	                        </li>
	                      
	                        <li>
	                          <span><i class="mini-ico-calendar"></i>08 Apr 2012</span> <br>
	                          <a class="post-link" href="/2012/04/08/daemons-em-php/">Daemons em PHP</a>
	                        </li>
	                      
	                        <li>
	                          <span><i class="mini-ico-calendar"></i>08 Apr 2012</span> <br>
	                          <a class="post-link" href="/2012/04/08/utilizando-php-na-linha-de-comando-com-zend-framework/">Utilizando PHP na linha de comando com Zend Framework</a>
	                        </li>
	                      
	                        <li>
	                          <span><i class="mini-ico-calendar"></i>21 Jan 2011</span> <br>
	                          <a class="post-link" href="/2011/01/21/trabalhando-com-imagens-utilizando-a-biblioteca-imagick/">Trabalhando com imagens utilizando a biblioteca Imagick</a>
	                        </li>
	                      
	                        <li>
	                          <span><i class="mini-ico-calendar"></i>26 Sep 2009</span> <br>
	                          <a class="post-link" href="/2009/09/26/nginx/">Nginx</a>
	                        </li>
	                      
	                        <li>
	                          <span><i class="mini-ico-calendar"></i>22 Apr 2008</span> <br>
	                          <a class="post-link" href="/2008/04/22/backup-incremental-simples-e-indolor/">Backup incremental simples e indolor</a>
	                        </li>
	                      
	                        <li>
	                          <span><i class="mini-ico-calendar"></i>05 Oct 2007</span> <br>
	                          <a class="post-link" href="/2007/10/05/internacionalizando-aplicacoes-baseadas-no-cakephp-1-2/">Internacionalizando Aplicações baseadas no CakePHP 1.2</a>
	                        </li>
	                      
	                        <li>
	                          <span><i class="mini-ico-calendar"></i>22 Sep 2007</span> <br>
	                          <a class="post-link" href="/2007/09/22/criando-um-access-point/">Criando um Access Point</a>
	                        </li>
	                      
	                    </ul>
	                </div>
	                <!-- end: Text Widget -->
	            </div>
	            <!-- end: Sidebar -->
	        </div>
	        <!--end: Row -->
	    </div>
	    <!--end: Container-->
	</div>
	<!-- end: Wrapper  -->

    <!-- start: Footer Menu -->
    <div id="footer-menu" class="hidden-tablet hidden-phone">
        <!-- start: Container -->
        <div class="container">
            <!-- start: Row -->
            <div class="row">
                <!-- start: Footer Menu Logo -->
                <div class="span2">
                    <div id="footer-menu-logo">
                        <a class="brand" href="/">mrprompt</a>
                    </div>
                </div>
                <!-- end: Footer Menu Logo -->

                <!-- start: Footer Menu Links-->
                <div class="span9">
                    <div id="footer-menu-links">
                        <ul id="footer-nav">
                            <li><a href="/">Início</a></li>
                            <li><a href="/sobre">Sobre</a></li>
                            <li><a href="/servicos">Serviços</a></li>
                            <li><a href="/blog">Blog</a></li>
                            <li><a href="/contato">Contato</a></li>
                        </ul>
                    </div>
                </div>
                <!-- end: Footer Menu Links-->

                <!-- start: Footer Menu Back To Top -->
                <div class="span1">
                    <div id="footer-menu-back-to-top">
                        <a href="#"></a>
                    </div>
                </div>
                <!-- end: Footer Menu Back To Top -->
            </div>
            <!-- end: Row -->
        </div>
        <!-- end: Container  -->
    </div>
    <!-- end: Footer Menu -->

    <!-- start: Copyright -->
    <div id="copyright">
        <!-- start: Container -->
        <div class="container">
            <div class="sixteen columns">
                <p>
                    &copy; 2014 - <a href="http://mrprompt.com.br">mrprompt.com.br</a>
                </p>
            </div>
        </div>
        <!-- end: Container  -->
    </div>
    <!-- end: Copyright -->

    <!-- start: Java Script -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script src="/js/jquery-1.8.2.js"></script>
    <script src="/js/isotope.js"></script>
    <script src="/js/jquery.imagesloaded.js"></script>
    <script src="/js/bootstrap.js"></script>
    <script src="/js/flexslider.js"></script>
    <script src="/js/carousel.js"></script>
    <script src="/js/jquery.cslider.js"></script>
    <script src="/js/slider.js"></script>
    <script src="/js/fancybox.js"></script>
    <script src="/js/twitter.js"></script>
    <script defer="defer" src="/js/custom.js"></script>
    <!-- start analytics -->
    <script>
        (function(i, s, o, g, r, a, m) {
            i['GoogleAnalyticsObject'] = r;
            i[r] = i[r] || function() {
                (i[r].q = i[r].q || []).push(arguments)
            }, i[r].l = 1 * new Date();
            a = s.createElement(o), m = s.getElementsByTagName(o)[0];
            a.async = 1;
            a.src = g;
            m.parentNode.insertBefore(a, m)
        })(window, document, 'script',
                '//www.google-analytics.com/analytics.js', 'ga');

        ga('create', 'UA-1337986-1', 'mrprompt.com.br');
        ga('send', 'pageview');
    </script>
    <!-- end analytics -->
    <!-- end: Java Script -->
</body>
</html>
<!-- Localized -->

